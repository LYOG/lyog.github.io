<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 盒子</title><meta name="description" content="A Blog Powered By Hexo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="https://www.liuyong.cc/atom.xml" title="盒子"></head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">盒子</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p class="selected">现在</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>过去</p></a><a href="/about" target="_self" class="li component-nav-item"><p>关于</p></a></ul></nav><!--        ul.shortcut-icons--><!--            each nav_item in theme.nav_icons--><!--                a(href=nav_item[1] target="_blank")--><!--                    img.icon(src=nav_item[0])--></header><main class="container"><div id="body-container"><div id="post-list" class="left"><div class="home post-list"><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2019/01/09/闲言碎语/" class="post-title-link">闲言碎语-1月9日</a></h2><div class="post-info">Jan 9, 2019</div><div class="post-content"><p>&emsp;&emsp;前些日子，长租公寓连续暴雷，身为北漂一族，我也未能幸免。刚开始的那几天，打投诉电话：住建部、市长热线、12315，加维权群，再到后来的法院起诉。这个本命年，可以说是很糟心了。</p></div><a href="/2019/01/09/闲言碎语/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2019/01/01/MySQL数据库如何支持emoji表情/" class="post-title-link">MySQL数据库如何支持emoji表情</a></h2><div class="post-info">Jan 1, 2019</div><div class="post-content"><p>最近做的一个微信公众号的项目，有一个需求是：通过openID获取到的用户基础信息并持久化到数据库中，当时也没有多想，哐哐哐就是一通写。后来测试反馈说有些用户信息无法存储，我查了一下日志，发现类似异常：<code>java.sql.SQLException: Incorrect string value: &#39;\xF0\x9F\x92\x94&#39; for column &#39;name&#39; at row 1</code>，这才发现自己忽略了一种情况，有些用户的昵称带有emoji表情，MySQL字符集使用的uft8，只能存储3个字节的数据，但是emoji表情是4个字节，这样数据持久化的时候就必然异常。</p></div><a href="/2019/01/01/MySQL数据库如何支持emoji表情/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/10/HashMap在多线程情况下还会导致死循环吗/" class="post-title-link">HashMap在多线程情况下还会导致死循环吗</a></h2><div class="post-info">Jun 10, 2018</div><div class="post-content"><p>先放结论，这个问题出现在JDK1.7及以前版本中，而现在JDK1.8中已经解决这个问题了。</p>
<h4 id="JDK1-7中的死循环"><a href="#JDK1-7中的死循环" class="headerlink" title="JDK1.7中的死循环"></a>JDK1.7中的死循环</h4><p>我们知道HashMap&lt;K,V&gt;存放的数据量大于了装载因子（默认75%），那么HashMap&lt;K,V&gt;就需要进行扩容操作，扩容的空间大小就是原来空间的两倍，但是扩容的时候需要rehash操作,然后赋给新的HashMap&lt;K,V&gt;。</p>
<p>JDK中需要使用resize()函数进行扩容，下面时resize()的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">int</span> newCapacity)</span> </span>&#123;</span><br><span class="line">        Entry[] oldTable = table;</span><br><span class="line">        <span class="keyword">int</span> oldCapacity = oldTable.length;</span><br><span class="line">        <span class="keyword">if</span> (oldCapacity == MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Entry[] newTable = <span class="keyword">new</span> Entry[newCapacity];</span><br><span class="line">        <span class="keyword">boolean</span> oldAltHashing = useAltHashing;</span><br><span class="line">        useAltHashing |= sun.misc.VM.isBooted() &amp;&amp;</span><br><span class="line">                (newCapacity &gt;= Holder.ALTERNATIVE_HASHING_THRESHOLD);</span><br><span class="line">        <span class="keyword">boolean</span> rehash = oldAltHashing ^ useAltHashing;</span><br><span class="line">        transfer(newTable, rehash);  <span class="comment">//transfer函数的调用</span></span><br><span class="line">        table = newTable;</span><br><span class="line">        threshold = (<span class="keyword">int</span>)Math.min(newCapacity * loadFactor, MAXIMUM_CAPACITY + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在resize()这个过程中,在并发情况下也是不会出现死循环的问题，关键问题是transfer函数的调用过程。</p></div><a href="/2018/06/10/HashMap在多线程情况下还会导致死循环吗/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/09/Rotate Image/" class="post-title-link">LeetCode — Rotate Image</a></h2><div class="post-info">Jun 9, 2018</div><div class="post-content"><p>You are given an <em>n</em> x <em>n</em> 2D matrix representing an image.</p>
<p>Rotate the image by 90 degrees (clockwise).</p>
<p><strong>Note:</strong></p>
<p>You have to rotate the image <a href="https://en.wikipedia.org/wiki/In-place_algorithm" target="_blank" rel="noopener"><strong>in-place</strong></a>, which means you have to modify the input 2D matrix directly. <strong>DO NOT</strong> allocate another 2D matrix and do the rotation.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Given input matrix = </span><br><span class="line"><span class="comment">[</span></span><br><span class="line"><span class="comment">  <span class="comment">[1,2,3]</span>,</span></span><br><span class="line"><span class="comment">  <span class="comment">[4,5,6]</span>,</span></span><br><span class="line"><span class="comment">  <span class="comment">[7,8,9]</span></span></span><br><span class="line"><span class="comment">]</span>,</span><br><span class="line"></span><br><span class="line">rotate the input matrix in-place such that it becomes:</span><br><span class="line"><span class="comment">[</span></span><br><span class="line"><span class="comment">  <span class="comment">[7,4,1]</span>,</span></span><br><span class="line"><span class="comment">  <span class="comment">[8,5,2]</span>,</span></span><br><span class="line"><span class="comment">  <span class="comment">[9,6,3]</span></span></span><br><span class="line"><span class="comment">]</span></span><br></pre></td></tr></table></figure></div><a href="/2018/06/09/Rotate Image/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/09/Valid Sudoku/" class="post-title-link">LeetCode — Valid Sudoku</a></h2><div class="post-info">Jun 9, 2018</div><div class="post-content"><p>Determine if a 9x9 Sudoku board is valid. Only the filled cells need to be validated <strong>according to the following rules</strong>:</p>
<ol>
<li>Each row must contain the digits <code>1-9</code> without repetition.</li>
<li>Each column must contain the digits <code>1-9</code> without repetition.</li>
<li>Each of the 9 <code>3x3</code> sub-boxes of the grid must contain the digits <code>1-9</code> without repetition.</li>
</ol>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/ff/Sudoku-by-L2G-20050714.svg/250px-Sudoku-by-L2G-20050714.svg.png" alt="img"><br>A partially filled sudoku which is valid.</p>
<p>The Sudoku board could be partially filled, where empty cells are filled with the character <code>&#39;.&#39;</code>.</p></div><a href="/2018/06/09/Valid Sudoku/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/09/Plus One/" class="post-title-link">LeetCode — Plus One</a></h2><div class="post-info">Jun 9, 2018</div><div class="post-content"><p>Given a <strong>non-empty</strong> array of digits representing a non-negative integer, plus one to the integer.</p>
<p>The digits are stored such that the most significant digit is at the head of the list, and each element in the array contain a single digit.</p>
<p>You may assume the integer does not contain any leading zero, except the number 0 itself.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [1,2,3]</span><br><span class="line">Output: [1,2,4]</span><br><span class="line">Explanation: The<span class="built_in"> array </span>represents the integer 123.</span><br></pre></td></tr></table></figure>
<p><strong>Example 2:</strong></p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: [4,3,2,1]</span><br><span class="line">Output: [4,3,2,2]</span><br><span class="line">Explanation: The<span class="built_in"> array </span>represents the integer 4321.</span><br></pre></td></tr></table></figure></div><a href="/2018/06/09/Plus One/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/09/Move Zeroes/" class="post-title-link">LeetCode — Move Zeroes</a></h2><div class="post-info">Jun 9, 2018</div><div class="post-content"><p>Given an array <code>nums</code>, write a function to move all <code>0</code>‘s to the end of it while maintaining the relative order of the non-zero elements.</p>
<p><strong>Example:</strong></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: <span class="string">[0,1,0,3,12]</span></span><br><span class="line">Output: <span class="string">[1,3,12,0,0]</span></span><br></pre></td></tr></table></figure>
<p><strong>Note</strong>:</p>
<ol>
<li>You must do this <strong>in-place</strong> without making a copy of the array.</li>
<li>Minimize the total number of operations.</li>
</ol></div><a href="/2018/06/09/Move Zeroes/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/09/Two Sum/" class="post-title-link">LeetCode — Two Sum</a></h2><div class="post-info">Jun 9, 2018</div><div class="post-content"><p>Given an array of integers, return <strong>indices</strong> of the two numbers such that they add up to a specific target.</p>
<p>You may assume that each input would have <strong>exactly</strong> one solution, and you may not use the <em>same</em> element twice.</p>
<p><strong>Example:</strong></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Given nums = [<span class="number">2</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>], target = <span class="number">9</span>,</span><br><span class="line"></span><br><span class="line">Because nums[<span class="number">0</span>] + nums[<span class="number">1</span>] = <span class="number">2</span> + <span class="number">7</span> = <span class="number">9</span>,</span><br><span class="line">return [<span class="number">0</span>, <span class="number">1</span>].</span><br></pre></td></tr></table></figure></div><a href="/2018/06/09/Two Sum/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/04/为什么wait-notify和notifyall定义在Object中/" class="post-title-link">为什么wait，notify和notifyall定义在Object中</a></h2><div class="post-info">Jun 4, 2018</div><div class="post-content"><p>为什么wait，notify和notifyall定义在Object中，而不是定义在Thread类中？</p>
<ol>
<li>wait和nofity在Java中主要是实现线程之间的通信，把它们定义在Object类中，可以使任何Java对象都可以拥有实现线程通讯机制的能力。</li>
<li>每个对象都可以作为锁。</li>
<li>在Java中，为了进入临界区代码段，线程需要获得锁并且等待锁可用。它们不知道哪些线程持有锁，但是它们知道锁由哪些线程持有。它们应该等待锁而不是去查找哪个线程在代码块中去要求它们释放锁。</li>
</ol></div><a href="/2018/06/04/为什么wait-notify和notifyall定义在Object中/" class="read-more">READ MORE</a></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/06/03/Cookie与Session的区别/" class="post-title-link">Cookie与Session的区别</a></h2><div class="post-info">Jun 3, 2018</div><div class="post-content"><h4 id="Cookie机制"><a href="#Cookie机制" class="headerlink" title="Cookie机制"></a>Cookie机制</h4><p>Cookies是服务器在本地机器上存储的小段文字并随每一个请求发送至同一个服务器。网络服务器用HTTP头向客户端发送Cookies，在客户端，浏览器解析这些Cookies并将它们保存为一个本地文件，它会自动将同一服务器的任何请求缚上这些Cookies。</p>
<p>具体来说Cookie机制采取的是<strong>在客户端保持状态</strong>的方案。它需要用户打开客户端的Cookie支持，它的作用就是为了<strong>解决HTTP协议无状态</strong>的缺陷。</p>
<p><strong>Cookie的内容主要包括：名字、值、过期时间、路径和域。</strong></p>
<p>路径和域一起构成Cookie的作用范围。</p>
<p>若不设置范围，则Cookie的生命周期为浏览器会话状态期间，关闭浏览器，Cookie就消失。这种Cookie称为会话Cookie，通常保存在内存中。而设置了过期时间的Cookie会被保存至硬盘。</p>
<h4 id="Session机制"><a href="#Session机制" class="headerlink" title="Session机制"></a>Session机制</h4><p>Session机制是一种服务器端的机制，服务器使用一种类似于散列表的结构来保存信息。</p>
<p>当程序需要为某个客户端的请求创建一个Session时，服务器首先检查这个客户端里知否已经包含一个Session标识，如果包含则按照Session ID来把这个Session检索出来，检索不到的话会新建一个。</p>
<p>如果客户端请求不包含Session ID，则为此客户端创建一个Session并生成一个与此Session相关联的Session ID，这个Session ID将在本次响应中返回给客户端。</p>
<p>保存这个Session ID的方式可以采用Cookie，但如果Cookie被人禁止的话，就必须使用其它机制来传递Session ID。通常使用的一种技术叫做URL重写，就是把Session ID直接附加在URL路径后面；还有一种技术叫做表单隐藏字段，就是服务器会自动修改表单，添加一个隐藏字段，以便表单提交时能欧巴Session ID传回给服务器。</p></div><a href="/2018/06/03/Cookie与Session的区别/" class="read-more">READ MORE</a></article></div></div></div><div id="sidebar" class="left"><div id="about-panel"><div class="info"><div class="title">Liu Yong</div><div class="url">https://www.liuyong.cc</div><div class="bio">我想出门晒太阳</div></div><img src="/images/avatar.jpg" class="avatar"></div><div id="friend-links-panel"><div class="panel-title"><p>LINKS</p></div><a href="http://www.liuyong.cc/bookList" target="_blank" class="link-item"><div class="link-container"><div class="site-name">书单</div><div class="site-desc">http://www.liuyong.cc/bookList</div></div></a><a href="http://www.liuyong.cc/about" target="_blank" class="link-item"><div class="link-container"><div class="site-name">关于我</div><div class="site-desc">http://www.liuyong.cc/about</div></div></a></div></div></div><div class="clear"></div></main><footer class="footer-container"><div class="paginator"><a href="/page/2/" class="next">NEXT</a></div><div class="copyright"><p>© 2017 - 2019 <a href="https://www.liuyong.cc">Liu Yong</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer></body></html>